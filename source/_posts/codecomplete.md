title: 《代码大全（第二版）》读书笔记
date: 2015-01-05 20:54:58
categories: 人丑就该多读书
tags:
---

今年元旦我在同学家里看到了一直想找的<<代码大全(第二版)>>.今天开始看,整理一下看到的好的东西。

<!--more -->

花了1个月，大体看了一遍，这本书主要讲的是软件开发过程（书中叫软件构建）中的各种经验。我觉得以后我还得慢慢读一遍。

## 第一部分：打好基础
-  软件开发不仅仅是写代码

	在公司做的一个8月版的项目-“账户管家”，修改过程中花费最多的时间就是阅读代码、找到要修改的地方，读懂别人写的代码（有些是8年前的代码，写代码的人都不在了）并且找到修改点，整个项目基本就完成了80%，真正要改动的地方只有一些查询条件。**敲代码**这个词语我觉得不太好，听了给人的感觉是把某处写好的代码原样输入到电脑中一样。**软件开发应当是一个创造性的过程**，敲代码只是其中一个必不可少的环节。

- 程序员是软件食物链的最后一环

	在健康的生态环境中，海鸥吃新鲜的鲑鱼，鲑鱼吃新鲜的青鱼，青鱼吃新鲜的水蝽。这是一条健康的食物链。 如果环境被污染了，水蝽在污染的水域游泳，那么海鸥，食物链的最后一环吃下的不仅仅是是不健康的鲑鱼体内的垃圾，还有青鱼，水蝽体内的污染物。在软件开发中，如果需求被污染了，那么它就会污染架构，最终导致程序员开发出的软件具有放射性污染，而且周身都是缺陷。 
- 要确定你的准备活动是在降低风险，而非增加风险
- 程序员使用熟悉的编程语言时，生产率率要比使用不熟悉的语言时要高

	IBM早期的一项研究表明，对编程语言有相当丰富经验的程序员的生产率比几乎没有经验的程序员高3倍。我觉得不止吧。学会语言的基本语法和熟练使用该语言完全是两个概念。书中提出了一种概念“深入一种语言去编程（Programming into a Language）”。有意思，同样一门语言有的人只能写出Hello World，有人却能写出一个操作系统。


## 第二部分：创建高质量的代码
- 软件的首要技术使命便是管理复杂度

	要避免做出“聪明的”设计，因为“聪明的”设计常常都是难以理解的。应该做出简单且易于理解的设计。说到这让我想起蓝色巨人IBM，IBM给出的设计方案巨复杂，感觉它是为了把自己的数据库（DB2）、服务器（AIX）、小型机、BTT框架等内容全都用上才设计了如此繁琐的方案。该方案造成的后果是未来如果你还想用这套方案，你就得付钱，想要换套方案得全部推倒重来。从长远来看12306选择自己开发程序是正确的。

	高扇入、低扇出这个我还是第一次听说。高扇入是说大量的类使用某个低层次上的类，低扇出是说让一个类少量地使用其他的类。

	精简性意味着设计出的系统没有多余的部分。话说我维护老代码的时候最有成就感的就是可以删除大量冗余代码，而程序测试没出问题。代码放在那里，就会让后来的人都会瞄一眼。
- 保持子程序的短小精悍也能帮助你减少思考的负担
- 类很像冰山：八分之七都是位于水面之下

## 第三部分：变量
- 书中有一项技能测试，自己给自己打分，很有意思，因为有些技能是作者乱造的，如果得分太高，建议直接阅读第33章“诚实”一节
- 缩短变量的生存时间，即变量从出现到最后一次使用之间的代码间隔尽量小
- 把变量和它对应的值绑定在一起的时间越晚，越灵活。不要硬编码
- 为状态变量取一个好名字，比*flag*好的
- 变量的命名规则很重要
- 自作聪明就是傻的另外一种说法

##第四部分：语句
- if else 如果出现的太多，可以试试将数据记录到表中，然后通过查表来解决

##第五部分：代码改善
- code review 很重要，花在这上面的时间是值得的。

	1. 首先，能够让你自己写代码的时候稍微注意一点，因为你知道代码写完后有人会看。
	2. 其次，老员工帮你看代码，能发现很多问题。虽然有些问题不影响程序的正确性。
	3. 最后，花在这上面的时间总比以后线上出问题再花时间改强吧，同样都是半天，效果可一点都不一样。
- 重构的理由
	- 代码重复。Don't Repeat Yourself（不要重复自己）。以前以为自己懂了，直到11月版的一个项目，涉及即期结汇、即期购汇、远期结汇、远期购汇，每次修改代码都得改4遍。
	
##第六部分：系统考虑
- Daily Build 和冒烟测试都是软件集成的好方法。

	在百度移动云实习的时候，每天下班前用Jenkins跑一下脚本，跑完后自动发邮件。“冒烟测试”源自硬件行业。对一个硬件或硬件组件进行更改或修复后，直接给设备加电。如果没有冒烟，则该组件就通过了测试。在软件中，“冒烟测试”这一术语描述的是在将代码更改嵌入到产品的源树中之前对这些更改进行验证的过程。	想法很好，前提是要**自动化**！！

	顺便说一句，回归测试也很有必要。投产后发现一个问题：客户提交了指令后，授权人查不到该指令，就是因为在项目后期修改了一个外币账号权限的问题导致的另外一个Bug。如果修改完之后，能自动化地再跑一边程序，错误就能被发现了。

##第七部分
- 注释不好只会帮倒忙

	好多老代码的注释都是废话，我猜是为了应付领导的。我觉得注释最基本的原则应该是自己看到注释后能立刻知道这段代码是干什么用的。要求再高点就是能提供这段代码提供不了的信息。

	我见过一个离职的老员工离职前写的代码和注释，惨不忍睹，参数名有t1,t2,t3……t24，变量有x1,x_1,还有各种DSB_(大傻逼)。这么写代码造成的后果是他的不可替代性，因为没人看的懂他的代码。
- 编程工作本质上是项无法监督的工作，因为没人真正清楚你正在做什么

	最近组长催的一个项目比较紧，我预估了10天的时间，结果给我压缩到5天。我说行吧，就开始写了，并且按时完成。但问题是我以前写代码都会自测，这次都是凭感觉，写完没有自测。后面肯定得出各种问题。
- 人们还荒唐地强调程序员有多少经验。“我们需要有五年以上C语言编程经验的程序员”就是愚蠢的说法。如果程序员过了前一两年还没有学好C语言，那么再加三年也没什么意义。

	用人单位之所以这么写“X年以上工作经验”估计也是找不出其他方法来筛选人才了，他们也不清楚需要什么样的人。
- 首先为人写程序，其次才是为机器

---
花了一个多月，看完了900多页的《代码大全（第2版）》。感觉我现在的编程经验还是太少，准备过两年再回头仔细看下这本经典书籍。